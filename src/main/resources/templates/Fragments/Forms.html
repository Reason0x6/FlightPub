<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<form id="login" th:action="@{/login}" th:object="${LoginRequest}" method="post">
    <div class="mb-3">
        <label for="exampleInputEmail1" class="form-label">Email address</label>
        <input type="email" name="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp">
        <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div>
    </div>
    <div class="mb-3">
        <label for="exampleInputPassword1" class="form-label">Password</label>
        <input type="password" name ="password" class="form-control" id="exampleInputPassword1">
    </div>
    <p style="color: red" th:if="${valid} != null">Username & Password did not match a valid account. Please try again.</p>

    <button type="submit" class="btn btn-primary">Submit</button>
</form>

<form id="search" th:action="@{/search}" th:object="${BasicSearch}" method="post">
    <input type="text" id="origin" name="originIn" placeholder="Fly From">
    <input type="text" id="destination" name="destinationIn" placeholder="Fly To">
    <label for="start" id="startLabel" style="font-size: 0.65em; margin-left: 10px; position: absolute;">Earliest Flight Date</label>
    <input type="date" id="start" name="start"
           th:value="${today}"
           th:min="${today}" th:max="${max}">
    <label for="end" id="endLabel" style="font-size: 0.65em; margin-left: 10px; position: absolute;">Latest Flight Date</label>
    <input type="date" id="end" name="end"
           th:value="${today}"
           th:min="${today}" th:max="${max}">


    <button type="submit" class="btn btn-primary btn-search" >Find Flights!</button><br>
    <input type="checkbox" name="nodest" id="nodest" style="width: 50px;"  onclick="allDest()">
    <label for="nodest">Show all destinations</label>
    <input type="checkbox" name="exactdate" id="exactdate" style="width: 50px;" onclick="adjustDate()">
    <label for="exactdate">Use Exact Date</label>
    <input type="checkbox" name="searchByArrival" id="searchByArrival" style="width: 50px;" onclick="adjustDate()">
    <label for="searchByArrival">Search by Arrival Times</label>

    <script>
        function allDest(){

            let val = document.getElementById("nodest");

            if(val.checked == true){
                document.getElementById("destination").disabled = true;
                document.getElementById("destination").value = "Show All";
            }else{
                document.getElementById("destination").disabled = false;
                document.getElementById("destination").value = "";
            }
        }
        function adjustDate(){
            let exact = document.getElementById("exactdate").checked;
            let arrival = document.getElementById("searchByArrival").checked;

            if((exact == true)&&(arrival == true)){
                document.getElementById("end").disabled = true;
                document.getElementById("end").value = "--/--/----";
                document.getElementById("startLabel").innerHTML = "Arrival Date";
                document.getElementById("endLabel").innerHTML = "";
            }else if((exact == true)&&(arrival == false)){
                document.getElementById("end").disabled = true;
                document.getElementById("end").value = "--/--/----";
                document.getElementById("startLabel").innerHTML = "Flight Date";
                document.getElementById("endLabel").innerHTML = "";
            }else if((exact == false)&&(arrival == true)){
                document.getElementById("end").disabled = false;
                document.getElementById("end").value = "";
                document.getElementById("startLabel").innerHTML = "Earliest Arrival Date";
                document.getElementById("endLabel").innerHTML = "Latest Arrival Date";
            }else{
                document.getElementById("end").disabled = false;
                document.getElementById("end").value = "";
                document.getElementById("startLabel").innerHTML = "Earliest Flight Date";
                document.getElementById("endLabel").innerHTML = "Latest Flight Date";
            }
        }
    </script>
</form>

<form id="registerUser" name="registerUser" onsubmit="return validateRegister()" th:action="@{/RegisterUser}" th:object="${UserRegister}" method="post">
    <input type="email" id="email" class="form-control" name="email" placeholder="Email"><br>
    <input type="text" id="firstname" class="form-control" name="firstname" placeholder="Firstname"><br>
    <input type="text" id="address" class="form-control" name="address" placeholder="Address"><br>

    <label id="airportlbl" class="form-label" name="airportlbl" >Preferred Airport</label><br>
    <select name="prefAirport" id="prefAirport" class="form-control">
        <option th:each="Location: ${locs}" th:value="${Location.getLocationID()}" th:text="${Location.getLocationID()} + ' - ' + ${Location.getLocation()}"></option>
    </select><br>

    <input type="password" id="password" class="form-control" name="password" placeholder="Password"><br>
    <input type="password" id="confirmpassword" class="form-control" name="confirmpassword" placeholder="Confirm Password"><br>
    <button type="submit" class="btn btn-primary btn-search">Create Account!</button>

    <script>
       function validateRegister() {
            let f =  document.forms["registerUser"];
            let x = true;

             if(f["email"].value == ""){ x = false; }
             if(f["firstname"].value == ""){ x = false; }
             if(f["address"].value == ""){ x = false; }
             if(f["password"].value == ""){ x = false; }
             if(f["confirmpassword"].value == ""){ x = false; }

              if (x == "") {
                alert("Please fill in all fields");
                return false;
              }
              else if(!(f["password"].value === f["confirmpassword"].value)){
                alert("Passwords do not match");
                return false;
              }
              else{
                return true;
              }
        }
    </script>
</form>

<!--REGIESTER USER--------------------------------------------------------------------------------------------------------------------------------------->
<form id="updateUser" name="registerUser" onsubmit="return validateRegister()" th:action="@{/RegisterUser}" th:object="${UserRegister}" method="post">
    <input type="email" id="email" class="form-control" name="email" th:value="${usr.getEmail()}"><br>
    <input type="text" id="firstname" class="form-control" name="firstname"  th:value="${usr.getFirstname()}"><br>

    <label id="airportlbl" class="form-label" name="airportlbl" >Preferred Airport</label><br>
    <select name="prefAirport" id="prefAirport" class="form-control">
        <option th:each="Location: ${locs}" th:value="${Location.getLocationID()}" th:text="${Location.getLocationID()} + ' - ' + ${Location.getLocation()}"></option>
    </select><br>

    <input type="password" id="password" class="form-control" name="password" placeholder="Password"  th:value="${usr.getPassword()}"><br>
    <input type="password" id="confirmpassword" class="form-control" name="confirmpassword" th:value="${usr.getPassword()}"><br>
    <button type="submit" class="btn btn-primary btn-search">Update Account!</button>

    <script>
        function validateRegister() {
            let f =  document.forms["registerUser"];
            let x = true;

            if(f["email"].value == ""){ x = false; }
            if(f["firstname"].value == ""){ x = false; }
            if(f["password"].value == ""){ x = false; }
            if(f["confirmpassword"].value == ""){ x = false; }

            if (x == "") {
                alert("Please fill in all fields");
                return false;
            }
            else if(!(f["password"].value === f["confirmpassword"].value)){
                alert("Passwords do not match");
                return false;
            }
            else{
                return true;
            }
        }
    </script>
</form>
<!--Advanced Search--------------------------------------------------------------------------------------------------------------------------------------->
<form id="advancedSearch" th:action="@{/advancedSearch}" th:object="${BasicSearch}" method="post">
    <input type="text" id="flightOrigin" name="originIn" placeholder="Fly From">
    <input type="text" id="flightDestination" name="destinationIn" placeholder="Fly To">
    <label for="earliest" id="earliestLabel" style="font-size: 0.65em; margin-left: 10px; position: absolute;">Earliest Flight</label>
    <input type="date" id="earliest" name="start"
           th:value="${today}"
           th:min="${today}" th:max="${max}">
    <label for="earliest" id="latestLabel" style="font-size: 0.65em; margin-left: 10px; position: absolute;">Latest Flight</label>
    <input type="date" id="latest" name="end"
           th:value="${today}"
           th:min="${today}" th:max="${max}">
    <label for="min">Price</label>
    <input type="number" id="min" name="minPrice" placeholder="Min" value="0" min="0" max="100000">
    <input type="number" id="max" name="maxPrice" placeholder="Max" value="100000" min="0" max="100000">
    <label for="directFlight">Direct flight Only</label>
    <input type="checkbox" name="directFlight" id="directFlight">
    <label for="rating">Minimum Ratings</label>
    <output>0</output>
    <input type="range" id="rating" name="rating" min="0" max="5" value="0" oninput="this.previousElementSibling.value = this.value">
    <label for="seats">Number of Seats</label>
    <input type="number" id="seats" name="seats" min="1" value="1">
    <label for="membership" th:if="${usr.isLoggedIn()} == true">Membership Flights</label>
    <input type="checkbox" id="membership" name="membershipFlights" th:if="${usr.isLoggedIn()} == true">

    <button type="submit" class="btn btn-primary btn-search" >Find Flights!</button><br>

    <input type="checkbox" name="nodest" id="nodestAdvanced" style="width: 50px;"  onclick="allDest()">
    <label for="nodestAdvanced">Show all destinations</label>
    <input type="checkbox" name="exactdate" id="exactdateAdvanced" style="width: 50px;" onclick="adjustDate()">
    <label for="exactdateAdvanced">Use Exact Date</label>
    <input type="checkbox" name="searchByArrival" id="searchByArrivalAdvanced" style="width: 50px;" onclick="adjustDate()">
    <label for="searchByArrivalAdvanced">Search by Arrival Times</label>

    <script>
        function allDest(){

            let val = document.getElementById("nodestAdvanced");

            if(val.checked == true){
                document.getElementById("flightDestination").disabled = true;
                document.getElementById("flightDestination").value = "Show All";
            }else{
                document.getElementById("flightDestination").disabled = false;
                document.getElementById("flightDestination").value = "";
            }
        }
        function adjustDate(){
            let exact = document.getElementById("exactdateAdvanced").checked;
            let arrival = document.getElementById("searchByArrivalAdvanced").checked;

            if((exact == true)&&(arrival == true)){
                document.getElementById("latest").disabled = true;
                document.getElementById("latest").value = "--/--/----";
                document.getElementById("earliestLabel").innerHTML = "Arrival Date";
                document.getElementById("latestLabel").innerHTML = "";
            }else if((exact == true)&&(arrival == false)){
                document.getElementById("latest").disabled = true;
                document.getElementById("latest").value = "--/--/----";
                document.getElementById("earliestLabel").innerHTML = "Flight Date";
                document.getElementById("latestLabel").innerHTML = "";
            }else if((exact == false)&&(arrival == true)){
                document.getElementById("latest").disabled = false;
                document.getElementById("latest").value = "";
                document.getElementById("earliestLabel").innerHTML = "Earliest Arrival Date";
                document.getElementById("latestLabel").innerHTML = "Latest Arrival Date";
            }else{
                document.getElementById("latest").disabled = false;
                document.getElementById("latest").value = "";
                document.getElementById("earliestLabel").innerHTML = "Earliest Flight Date";
                document.getElementById("latestLabel").innerHTML = "Latest Flight Date";
            }
        }
    </script>
</form>
<!--Register Search--------------------------------------------------------------------------------------------------------------------------------------->
<form id="registerUser" name="registerUser" onsubmit="return validateRegister()" th:action="@{/RegisterUser}" th:object="${UserRegister}" method="post">
    <input type="email" id="email" class="form-control" name="email" placeholder="Email"><br>
    <input type="text" id="firstname" class="form-control" name="firstname" placeholder="Firstname"><br>
    <input type="text" id="address" class="form-control" name="address" placeholder="Address"><br>

    <label id="airportlbl" class="form-label" name="airportlbl" >Preffered Airport</label><br>
    <select name="prefAirport" id="prefAirport" class="form-control">
        <option th:each="Location: ${locs}" th:value="${Location.getLocationID()}" th:text="${Location.getLocationID()} + ' - ' + ${Location.getLocation()}"></option>
    </select><br>

    <input type="password" id="password" class="form-control" name="password" placeholder="Password"><br>
    <input type="password" id="confirmpassword" class="form-control" name="confirmpassword" placeholder="Confirm Password"><br>
    <button type="submit" class="btn btn-primary btn-search">Create Account!</button>

    <script>
       function validateRegister() {
            let f =  document.forms["registerUser"];
            let x = true;

             if(f["email"].value == ""){ x = false; }
             if(f["firstname"].value == ""){ x = false; }
             if(f["address"].value == ""){ x = false; }
             if(f["password"].value == ""){ x = false; }
             if(f["confirmpassword"].value == ""){ x = false; }

              if (x == "") {
                alert("Please fill in all fields");
                return false;
              }
              else if(!(f["password"].value === f["confirmpassword"].value)){
                alert("Passwords do not match");
                return false;
              }
              else{
                return true;
              }
        }
    </script>
</form>
</html>